<link rel="stylesheet" href="style/style.css" />

<!DOCTYPE html><!-- HTML5 -->
<html prefix="og: http://ogp.me/ns#" lang="it-IT" dir="ltr">
	<head>
		<link rel="stylesheet" href="style/style.css" />
		<title>italo </title>
		<meta charset="utf-8" />
		<!--[if IE]><meta http-equiv="ImageToolbar" content="False" /><![endif]-->
		<meta name="generator" content="Incomedia WebSite X5 Evo 2024.4.11 - www.websitex5.com" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		
		<link rel="stylesheet" href="style/reset.css?2024-4-11-0" media="screen,print" />
		<link rel="stylesheet" href="style/print.css?2024-4-11-0" media="print" />
		<link rel="stylesheet" href="style/style.css?2024-4-11-0" media="screen,print" />
		<link rel="stylesheet" href="style/template.css?2024-4-11-0" media="screen" />
		<link rel="stylesheet" href="pcss/index.css?2024-4-11-0-638892339669416042" media="screen,print" />
		<script src="res/jquery.js?2024-4-11-0"></script>
		<script src="res/x5engine.js?2024-4-11-0" data-files-version="2024-4-11-0"></script>
		<script>
			window.onload = function(){ checkBrowserCompatibility('Il Browser che stai utilizzando non supporta le funzionalit√† richieste per visualizzare questo Sito.','Il Browser che stai utilizzando potrebbe non supportare le funzionalit√† richieste per visualizzare questo Sito.','[1]Aggiorna il tuo browser[/1] oppure [2]procedi ugualmente[/2].','http://outdatedbrowser.com/'); };
			x5engine.utils.currentPagePath = 'index.html';
			x5engine.boot.push(function () { x5engine.imPageToTop.initializeButton({}); });
		</script>
		
		<link rel="stylesheet" href="style/style.css" />
		
	</head>
	<body>
		<div id="imPageExtContainer">
			<div id="imPageIntContainer">
				<div id="imHeaderBg"></div>
				<div id="imFooterBg"></div>
				<div id="imPage">
					<header id="imHeader">
						<h1 class="imHidden">italo </h1>
						<div id="imHeaderObjects"><div id="imHeader_imObjectImage_01_wrapper" class="template-object-wrapper"><div id="imHeader_imObjectImage_01"><div id="imHeader_imObjectImage_01_container"><img src="images/Immagine-2025-06-25-193403.png" title="" alt="" width="311" height="61" />
</div></div></div><div id="imHeader_imObjectImage_02_wrapper" class="template-object-wrapper"><div id="imHeader_imObjectImage_02"><div id="imHeader_imObjectImage_02_container"><img src="images/Immagine-2025-06-29-202948_wl3mvqac.png" title="" alt="" width="51" height="46" />
</div></div></div><div id="imHeader_imObjectImage_03_wrapper" class="template-object-wrapper"><div id="imHeader_imObjectImage_03"><div id="imHeader_imObjectImage_03_container"><img src="images/Immagine-2025-06-29-201711.png" title="" alt="" width="105" height="54" />
</div></div></div><div id="imHeader_imObjectImage_04_wrapper" class="template-object-wrapper"><div id="imHeader_imObjectImage_04"><div id="imHeader_imObjectImage_04_container"><img src="images/Immagine-2025-06-29-201545.png" title="" alt="" width="57" height="57" />
</div></div></div></div>
					</header>
					<div id="imStickyBarContainer">
						<div id="imStickyBarGraphics"></div>
						<div id="imStickyBar">
							<div id="imStickyBarObjects"></div>
						</div>
					</div>
					<a class="imHidden" href="#imGoToCont" title="Salta il menu di navigazione">Vai ai contenuti</a>
					<div id="imSideBar">
						<div id="imSideBarObjects"></div>
					</div>
					<div id="imContentGraphics"></div>
					<main id="imContent">
						<a id="imGoToCont"></a>
						<div id="imPageRow_1" class="imPageRow">
						
						</div>
						<div id="imCell_1" class=""> <div id="imCellStyleGraphics_1"></div><div id="imCellStyleBorders_1"></div><div id="imTextObject_01">
							<div data-index="0"  class="text-tab-content grid-prop current-tab "  id="imTextObject_01_tab0" style="opacity: 1; ">
								<div class="text-inner">
									<div><b class="fs20lh1-5 cf1"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</b></div><div><b class="fs20lh1-5 cf1"><br></b></div><div><b class="fs20lh1-5 cf1"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</b><b class="fs26lh1-5 cf1 ff1">Acquista biglietto</b></div>
								</div>
							</div>
						
						</div>
						</div><div id="imPageRow_2" class="imPageRow">
						<div style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; overflow: hidden;"><div id="imPageRowGraphics_2"></div></div>
						</div>
						<div id="imCell_6" class=""> <div id="imCellStyleGraphics_6"></div><div id="imCellStyleBorders_6"></div><div id="imHTMLObject_06" class="imHTMLObject" style="text-align: center; width: 100%; overflow: hidden;"><!DOCTYPE html>
						<html lang="it">
						<head>
						  <meta charset="UTF-8" />
						  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
						  <title>italotreno.it - Prenotazione</title>
						  <link rel="stylesheet" href="style.css" />
						  <style>
						    body {
						      margin: 0;
						      font-family: Arial, sans-serif;
						      background: url('images/duomo.jpg') center/cover no-repeat fixed;
						      font-size: 16px;
						      color: #333;
						    }
						
						    .form-box {
						      max-width: 600px;
						      margin: 60px auto;
						      background-color: rgba(255, 255, 255, 0.92);
						      padding: 30px;
						      border-radius: 12px;
						      box-shadow: 0 0 14px rgba(0,0,0,0.2);
						    }
						
						    .header {
						      background-color: #b2002e;
						      color: white;
						      padding: 16px;
						      text-align: center;
						      font-size: 20px;
						      font-weight: bold;
						      border-radius: 6px;
						      margin-bottom: 20px;
						    }
						
						    .form-row {
						      display: flex;
						      gap: 10px;
						      margin-bottom: 14px;
						    }
						
						    input, select {
						      flex: 1;
						      padding: 12px;
						      font-size: 15px;
						      border: 1px solid #ccc;
						      border-radius: 6px;
						      box-sizing: border-box;
						    }
						
						    input[type="date"] {
						      background-image: url('https://cdn-icons-png.flaticon.com/512/747/747310.png');
						      background-repeat: no-repeat;
						      background-position: right 10px center;
						      background-size: 20px;
						      padding-right: 36px;
						    }
						
						    input[type="number"] {
						      background-image: url('https://cdn-icons-png.flaticon.com/512/149/149071.png');
						      background-repeat: no-repeat;
						      background-position: right 10px center;
						      background-size: 18px;
						      padding-right: 36px;
						    }
						
						    .search-btn {
						      width: 100%;
						      background-color: #b2002e;
						      color: white;
						      font-size: 16px;
						      padding: 14px;
						      border: none;
						      border-radius: 6px;
						      cursor: pointer;
						      font-weight: bold;
						    }
						
						    #risultati {
						      margin-top: 20px;
						      text-align: center;
						    }
						
						    .message-box {
						      max-width: 600px;
						      margin: 60px auto;
						      background-color: rgba(255, 255, 255, 0.92);
						      padding: 30px;
						      border-radius: 12px;
						      box-shadow: 0 0 14px rgba(0,0,0,0.2);
						      text-align: center;
						    }
						
						    a {
						      color: #b2002e;
						      font-weight: bold;
						      text-decoration: none;
						      display: inline-block;
						      margin-top: 12px;
						    }
						
						    @media screen and (max-width: 480px) {
						      .form-row {
						        flex-direction: column;
						      }
						
						      input, select {
						        font-size: 14px;
						        padding: 10px;
						      }
						
						      .search-btn {
						        font-size: 14px;
						        padding: 12px;
						      }
						    }
						  </style>
						</head>
						<body>
						
						  <div class="form-box">
						    <div class="header">italotreno.it</div>
						
						    <form id="italotreni-form">
						      <div class="form-row">
						        <input type="text" id="from" placeholder="Da: Citt√†/Stazione" list="stazioni" required />
						        <input type="text" id="to" placeholder="A: Citt√†/Stazione" list="stazioni" required />
						      </div>
						
						      <datalist id="stazioni">
						        <option value="Milano">
						        <option value="Roma">
						        <option value="Napoli">
						        <option value="Torino">
						        <option value="Firenze">
						        <option value="Bologna">
						      </datalist>
						
						      <div class="form-row">
						        <input type="date" id="date-andata" required />
						        <input type="date" id="date-ritorno" />
						      </div>
						
						      <div class="form-row">
						        <input type="number" id="passengers" min="1" max="9" value="1" required placeholder="Passeggeri" />
						        <select id="ambiente" required>
						          <option value="">Ambiente</option>
						          <option value="Smart">Smart</option>
						          <option value="Club">Club</option>
						          <option value="Prima">Prima</option>
						        </select>
						      </div>
						
						      <input type="email" id="email" required placeholder="Email" />
						      <button type="submit" class="search-btn">Prenota e paga</button>
						
						      <div id="risultati"></div>
						    </form>
						  </div>
						
						  <!-- Messaggi dinamici -->
						  <div id="success-message" class="message-box" style="display:none;">
						    <div class="header">italotreno.it</div>
						    <p>üéâ La tua prenotazione √® stata confermata con successo!<br />Riceverai un'email con tutti i dettagli.</p>
						    <a href="index.html">‚Üê Torna alla home</a>
						  </div>
						
						  <div id="cancel-message" class="message-box" style="display:none;">
						    <div class="header">italotreno.it</div>
						    <p>‚ùå La prenotazione √® stata annullata o non completata.<br />Nessun importo √® stato addebitato.</p>
						    <a href="index.html">‚Üê Torna alla home</a>
						  </div>
						
						  <script src="https://js.stripe.com/v3/"></script>
						  <script>
						    const stripe = Stripe("pk_live_51RcZZKFt7EaY9OTPn4hu3z4ZYfvJLZ1JsqNJhsyKj7T5BBSQCDOGVMDq5YUCkYL5HqsqoE9et25CbUjGZkAdpblO00lNy34est");
						
						    document.getElementById("italotreni-form").addEventListener("submit", async function(e) {
						      e.preventDefault();
						
						      const dati = {
						        from: document.getElementById("from").value,
						        to: document.getElementById("to").value,
						        data: document.getElementById("date-andata").value,
						        ritorno: document.getElementById("date-ritorno").value,
						        passeggeri: document.getElementById("passengers").value,
						        ambiente: document.getElementById("ambiente").value,
						        email: document.getElementById("email").value,
						        orario: "08:40",
						        prezzo: 3990
						      };
						
						      const response = await fetch("/.netlify/functions/crea-sessione-con-google", {
						        method: "POST",
						        headers: { "Content-Type": "application/json" },
						        body: JSON.stringify(dati)
						      });
						
						      const result = await response.json();
						      if (result.id) {
						        stripe.redirectToCheckout({ sessionId: result.id });
						      } else {
						        document.getElementById("risultati").innerText = "Errore: " + result.error;
						      }
						    });
						
						    // Visualizza messaggio dinamico
						    const params = new URLSearchParams(window.location.search);
						    const esito = params.get("esito");
						
						    if (esito === "success") {
						      document.querySelector(".form-box").style.display = "none";
						      document.getElementById("success-message").style.display = "block";
						    } else if (esito === "cancel") {
						      document.querySelector(".form-box").style.display = "none";
						      document.getElementById("cancel-message").style.display = "block";
						    }
						  </script>
						
						  <noscript>
						    <div style="text-align:center; background: #fdd; padding: 16px; font-weight: bold;">
						      ‚ö†Ô∏è Per visualizzare correttamente questo sito √® necessario abilitare JavaScript.
						    </div>
						  </noscript>
						</body>
						</html>
						</div></div><div id="imCell_2" class=""> <div id="imCellStyleGraphics_2"></div><div id="imCellStyleBorders_2"></div><div id="imObjectImage_02"><div id="imObjectImage_02_container"><img src="images/Immagine-2025-07-06-030855.png" title="" alt="" width="588" height="368" />
						</div></div></div><div id="imPageRow_3" class="imPageRow">
						
						</div>
						<div id="imCell_3" class=""> <div id="imCellStyleGraphics_3"></div><div id="imCellStyleBorders_3"></div><div id="imObjectImage_03"><div id="imObjectImage_03_container"><img src="images/Immagine-2025-07-06-032537.png" title="" alt="" width="593" height="677" />
						</div></div></div>
					</main>
					<footer id="imFooter">
						<div id="imFooterObjects"><div id="imFooter_imObjectImage_01_wrapper" class="template-object-wrapper"><div id="imFooter_imObjectImage_01"><div id="imFooter_imObjectImage_01_container"><img src="images/Immagine-2025-07-01-000455.png" title="" alt="" width="393" height="226" />
</div></div></div></div>
					</footer>
				</div>
				<span class="imHidden"><a href="#imGoToCont" title="Rileggi i contenuti della pagina">Torna ai contenuti</a></span>
			</div>
		</div>
		<script src="https://js.stripe.com/v3/"></script>
		
		<script>
		
		const stripe = Stripe('pk_live_51RcZZKFt7EaY9OTPn4hu3z4ZYfvJLZ1JsqNJhsyKj7T5BBSQCDOGVMDq5YUCkYL5HqsqoE9et25CbUjGZkAdpblO00lNy34est'); // Inserisci la tua chiave pubblica Stripe
		
		
		
		document.addEventListener('DOMContentLoaded', () => {
		
		  const form = document.getElementById('train-search-form');
		
		  const results = document.getElementById('search-results');
		
		
		
		  form.addEventListener('submit', async (e) => {
		
		    e.preventDefault();
		
		    const query = new URLSearchParams(new FormData(form)).toString();
		
		    results.innerHTML = 'üîé Ricerca in corso...';
		
		
		
		    try {
		
		      const res = await fetch('/.netlify/functions/searchTrains?' + query);
		
		      const trains = await res.json();
		
		      results.innerHTML = trains.length ? trains.map(t => `
		
		        <div class="train-result">
		
		          <p><strong>${t.TrainNumber}</strong><br>${t.DepartureTime} ‚Üí ${t.ArrivalTime}<br>Prezzo: ‚Ç¨${t.Price}</p>
		
		          <button onclick="bookTrain('${t.TrainNumber}', ${parseFloat(t.Price) * 100})">Prenota</button>
		
		        </div>
		
		      `).join('') : '<p>‚ùå Nessun treno trovato.</p>';
		
		    } catch {
		
		      results.innerHTML = '<p>‚ö†Ô∏è Errore nella ricerca.</p>';
		
		    }
		
		  });
		
		});
		
		
		
		async function bookTrain(trainNumber, amount) {
		
		  try {
		
		    const res = await fetch('/.netlify/functions/create-checkout-session', {
		
		      method: 'POST',
		
		      headers: { 'Content-Type': 'application/json' },
		
		      body: JSON.stringify({ trainNumber, amount })
		
		    });
		
		    const data = await res.json();
		
		    if (data.url) {
		
		      window.location.href = data.url;
		
		    } else {
		
		      alert("‚ùå Pagamento non avviato.");
		
		    }
		
		  } catch {
		
		    alert('‚ö†Ô∏è Errore durante il pagamento.');
		
		  }
		
		}
		
		</script>
		<noscript class="imNoScript"><div class="alert alert-red">Per poter utilizzare questo sito √® necessario attivare JavaScript.</div></noscript>
	</body>
</html>
